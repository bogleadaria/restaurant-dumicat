create table category
(
    category_id int auto_increment
        primary key,
    name        varchar(32) not null
);

create table client
(
    client_id int auto_increment
        primary key,
    name      varchar(32) not null,
    phone     varchar(20) not null,
    mail      varchar(32) null,
    address   varchar(60) null
);

create table ingredients
(
    ingredient_id int auto_increment
        primary key,
    name          varchar(32) not null,
    is_allergen   tinyint(1)  not null
);

create table menu
(
    menu_id int auto_increment
        primary key,
    name    varchar(32) not null
);

create table product
(
    product_id  int auto_increment
        primary key,
    category_id int         null,
    name        varchar(32) not null,
    price       int         null,
    stock       int         not null,
    constraint product_category_category_id_fk
        foreign key (category_id) references category (category_id)
);

create table gallery
(
    photo_id     int auto_increment
        primary key,
    content_type varchar(50)  not null,
    file_name    varchar(255) not null,
    data         longblob     not null,
    product_id   int          null,
    constraint gallery_product___fk
        foreign key (product_id) references product (product_id)
);

create table menu_item
(
    menu_id       int not null,
    category_id   int not null,
    product_id    int not null,
    ingredient_id int not null,
    constraint category__fk
        foreign key (category_id) references category (category_id),
    constraint ingredients__fk
        foreign key (ingredient_id) references ingredients (ingredient_id),
    constraint menu_item__fk
        foreign key (menu_id) references menu (menu_id),
    constraint product___fk
        foreign key (product_id) references product (product_id)
);

create table `order`
(
    order_id    int auto_increment
        primary key,
    status      varchar(10) null,
    total_price int         not null,
    client_id   int         not null,
    product_id  int         not null,
    constraint client__fk
        foreign key (client_id) references client (client_id),
    constraint product__fk
        foreign key (product_id) references product (product_id)
);

create table `product-ingredient`
(
    product_id    int not null,
    ingredient_id int not null,
    constraint ingredient__fk
        foreign key (ingredient_id) references ingredients (ingredient_id),
    constraint product_fk
        foreign key (product_id) references product (product_id)
);

create table `table`
(
    table_id     int auto_increment
        primary key,
    number       int not null,
    seats_number int null
);

create table reservation
(
    reservation_id   int auto_increment
        primary key,
    client_id        int         not null,
    table_id         int         not null,
    reservation_date date        not null,
    reservation_time time        not null,
    people_count     int         not null,
    status           varchar(10) null,
    constraint client___fk
        foreign key (client_id) references client (client_id),
    constraint table___fk
        foreign key (table_id) references `table` (table_id)
);

create table ticket
(
    ticket_id     int auto_increment
        primary key,
    ticket_number int not null,
    product_id    int not null,
    order_id      int not null,
    constraint ticket_order___fk
        foreign key (order_id) references `order` (order_id),
    constraint ticket_product__fk
        foreign key (product_id) references product (product_id)
);

