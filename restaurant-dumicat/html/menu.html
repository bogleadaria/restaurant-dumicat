<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Albert+Sans:wght@100;400;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../css/shared.css" />
    <link rel="stylesheet" href="../css/menu.css" />
    <title>Restaurant Dumicat</title>
  </head>
  <body>
        <header>
      <div id="logo">
        <a href="../html/index.html"><img src="../images/Dumicat.png" /></a>
      </div>
      <nav>
        <ul>
          <li><a href="../html/menu.html">Menu</a></li>
          <li><a href="../html/gallery.html">Gallery</a></li>
          <li><a href="../html/contacts.html">Contacts</a></li>
          <li><a href="../html/order.html">Order</a></li>
          <li><a href="../html/book-table.html">Book A Table</a></li>
        </ul>
      </nav>
    </header>
    
    <main>
      <section id="menu-header">
        <h1>Our Delicious Menu</h1>
        <p>Explore culinary perfection</p>
      </section>

      <section class="menu-category">
        
        <div class="menu-grid" id="menu-root">
    </div>
      </section>
    </main>

    <footer>
      <img src="../images/Dumicat.png" />
      <ul>
        <li>
          <p>Strada Deliciilor nr. 5</p>
          <p>Timișoara, România</p>
        </li>
        <li>
          <a href="../html/contacts.html">Contacts</a>
        </li>
                <li>
          <a href="https://www.facebook.com">Facebook</a>
        </li>
        <li>
          <a href="https://www.instagram.com">Instagram</a>
        </li>
      </ul>
      <ul>
        <li>
          <a href="../html/index.html">Home</a>
        </li>
        <li>
          <a href="../html/menu.html">Menu</a>
        </li>
        <li>
          <a href="../html/gallery.html">Gallery</a>
        </li>

        <li>
          <a href="../html/order.html">Order</a>
        </li>
        <li>
          <a href="../html/book-table.html">Book A Table</a>
        </li>
      </ul>
    </footer>

  <script>
    const API_URL = "localhost:5000/api";

    window.addEventListener('DOMContentLoaded', async () => {
        try {
            // Fetch produse si galerie
            const [prodRes, galRes] = await Promise.all([
                fetch(`${API_URL}/product`),
                fetch(`${API_URL}/gallery`)
            ]);
            const products = await prodRes.json();
            const galleries = await galRes.json();

            const container = document.getElementById('menu-root');
            container.innerHTML = '';

            // Render meniu
            products.forEach(prod => {
                // Găsim poza corespunzătoare produsului
                const photo = galleries.find(g => g.productId === prod.id);
                const imageUrl = photo ? `${API_URL}/gallery/${photo.id}/image` : '../images/Dumicat.png';

                const card = document.createElement('div');
                card.className = 'dish-card';
                card.innerHTML = `
                    <img src="${imageUrl}" alt="${prod.name}">
                    <div class="dish-info">
                        <h3>${prod.name}</h3>
                        <p style="color: #f28c0f; font-weight: bold; font-size: 1.2em;">${prod.price} RON</p>
                        <p class="ingredients-list" style="display:block; margin-top:10px;">
                            Stock: ${prod.stock} items available.
                        </p>
                    </div>
                `;
                container.appendChild(card);
            });
        } catch (err) {
            console.error(err);
            document.getElementById('menu-root').innerHTML = "<p style='color:white;'>Loading menu failed...</p>";
        }
    });
</script>
    </main>
  </body